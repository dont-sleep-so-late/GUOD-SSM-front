"use strict";(self["webpackChunkssm"]=self["webpackChunkssm"]||[]).push([[276],{4276:function(t,e,a){a.r(e),a.d(e,{default:function(){return u}});var s=function(){var t=this,e=t._self._c;return e("div",[e("el-select",{on:{change:t.changeOtherList},model:{value:t.value,callback:function(e){t.value=e},expression:"value"}},t._l(t.options,(function(t){return e("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1),"1"===this.value?e("el-table",{ref:"multipleTable",staticStyle:{width:"100%","margin-top":"10px"},attrs:{data:t.tableData,"tooltip-effect":"dark",border:"",stripe:""}},[e("el-table-column",{attrs:{label:"租用器材",prop:"equipmentName"}}),e("el-table-column",{attrs:{prop:"status",label:"租用状态"},scopedSlots:t._u([{key:"default",fn:function(a){return[0===a.row.status?e("el-tag",{attrs:{size:"small",type:"info"}},[t._v("待审批")]):1===a.row.status?e("el-tag",{attrs:{size:"small",type:"success"}},[t._v("通过")]):2===a.row.status?e("el-tag",{attrs:{size:"small",type:"danger"}},[t._v("驳回")]):3===a.row.status?e("el-tag",{attrs:{size:"small"}},[t._v("归还")]):e("el-tag",{attrs:{size:"small",type:"success"}},[t._v("归还成功")]),0===a.row.repairsStatus?e("el-tag",{attrs:{size:"small"}},[t._v("报修中...")]):t._e()]}}],null,!1,3586718883)}),e("el-table-column",{attrs:{prop:"starttime",label:"租用开始时间"}}),e("el-table-column",{attrs:{prop:"starttime",label:"租用结束时间"}}),e("el-table-column",{attrs:{prop:"icon",width:"300",label:"操作"},scopedSlots:t._u([{key:"default",fn:function(a){return[1===a.row.status?e("el-button",{attrs:{type:"text"},on:{click:function(e){return t.getBackInfo(a.row.id)}}},[t._v("归还")]):t._e(),1!==a.row.status||1!==a.row.repairsStatus&&null!==a.row.repairsStatus?t._e():e("el-divider",{attrs:{direction:"vertical"}}),1!==a.row.status&&3!==a.row.status&&4!==a.row.status||1!==a.row.repairsStatus&&null!==a.row.repairsStatus?t._e():e("el-button",{attrs:{type:"text"},on:{click:function(e){return t.repairs(a.row.id,a.row.userid)}}},[t._v("报修")])]}}],null,!1,3463505526)})],1):t._e(),"2"===this.value?e("el-table",{ref:"multipleTable",staticStyle:{width:"100%","margin-top":"10px"},attrs:{data:t.tableData,"tooltip-effect":"dark",border:"",stripe:""}},[e("el-table-column",{attrs:{label:"竞赛名称",prop:"competitionName"}}),e("el-table-column",{attrs:{prop:"status",label:"参赛状态"},scopedSlots:t._u([{key:"default",fn:function(a){return[0===a.row.status?e("el-tag",{attrs:{size:"small",type:"success"}},[t._v("已报名")]):1===a.row.status?e("el-tag",{attrs:{size:"small",type:"danger"}},[t._v("取消报名")]):t._e()]}}],null,!1,2696783030)}),e("el-table-column",{attrs:{prop:"created",label:"参赛时间"}}),e("el-table-column",{attrs:{prop:"icon",width:"300",label:"操作"},scopedSlots:t._u([{key:"default",fn:function(a){return[new Date<a.row.competitionStartTime?e("div",[0===a.row.status?e("el-button",{attrs:{type:"text"},on:{click:function(e){return t.cancel(a.row.competitionid)}}},[t._v("取消报名")]):e("el-button",{attrs:{type:"text"},on:{click:function(e){return t.apply(a.row.competitionid)}}},[t._v("报名")])],1):t._e()]}}],null,!1,3251369170)})],1):t._e(),"3"===this.value?e("el-table",{ref:"multipleTable",staticStyle:{width:"100%","margin-top":"10px"},attrs:{data:t.tableData,"tooltip-effect":"dark",border:"",stripe:""}},[e("el-table-column",{attrs:{label:"预约编号",width:"80",prop:"id"}}),e("el-table-column",{attrs:{prop:"placeName",label:"预约场地",width:"150"}}),e("el-table-column",{attrs:{prop:"orderdate",label:"预约日期"}}),e("el-table-column",{attrs:{prop:"orderstart",label:"预约开始时间(点)"}}),e("el-table-column",{attrs:{prop:"orderend",label:"预约结束时间(点)"}}),e("el-table-column",{attrs:{prop:"price",label:"预约订单价格"}}),e("el-table-column",{attrs:{prop:"status",label:"预约状态"},scopedSlots:t._u([{key:"default",fn:function(a){return[0===a.row.status?e("el-tag",{attrs:{size:"small",type:"success"}},[t._v("已预约")]):e("el-tag",{attrs:{size:"small",type:"danger"}},[t._v("取消预约")])]}}],null,!1,1825603953)}),e("el-table-column",{attrs:{prop:"created",width:"200",label:"预约时间"}}),e("el-table-column",{attrs:{prop:"icon",width:"250",label:"操作"},scopedSlots:t._u([{key:"default",fn:function(a){return[new Date<new Date(a.row.orderdate)?e("div",[0===a.row.status?e("el-button",{attrs:{type:"text"},on:{click:function(e){return t.cancelAppointment(a.row.id)}}},[t._v("取消预约")]):t._e()],1):t._e()]}}],null,!1,1738476937)})],1):t._e(),e("el-pagination",{staticStyle:{"margin-top":"10px"},attrs:{layout:"total, sizes, prev, pager, next, jumper","page-sizes":[10,20,50,100],"current-page":t.current,"page-size":t.size,total:t.total},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}}),e("el-dialog",{attrs:{title:"归还",visible:t.backFlag,width:"600px","before-close":t.handleClose},on:{"update:visible":function(e){t.backFlag=e}}},[e("el-form",{ref:"editForm",attrs:{model:t.editForm}},[e("el-form-item",{attrs:{label:"器材名称","label-width":"100px"}},[e("el-input",{attrs:{disabled:!0,autocomplete:"off"},model:{value:t.editForm.equipmentName,callback:function(e){t.$set(t.editForm,"equipmentName",e)},expression:"editForm.equipmentName"}})],1),e("el-form-item",{attrs:{label:"租用数量","label-width":"100px"}},[e("el-input",{attrs:{disabled:!0,autocomplete:"off"},model:{value:t.editForm.number,callback:function(e){t.$set(t.editForm,"number",e)},expression:"editForm.number"}})],1),e("el-form-item",{attrs:{label:"租用开始时间","label-width":"100px"}},[e("el-input",{attrs:{disabled:!0,autocomplete:"off"},model:{value:t.editForm.starttime,callback:function(e){t.$set(t.editForm,"starttime",e)},expression:"editForm.starttime"}})],1),e("el-form-item",{attrs:{label:"租用结束时间","label-width":"100px"}},[e("el-input",{attrs:{disabled:!0,autocomplete:"off"},model:{value:t.editForm.endtime,callback:function(e){t.$set(t.editForm,"endtime",e)},expression:"editForm.endtime"}})],1),e("el-form-item",{attrs:{label:"需支付总金额","label-width":"100px"}},[e("el-input",{attrs:{disabled:!0,autocomplete:"off"},model:{value:t.editForm.totalmoney,callback:function(e){t.$set(t.editForm,"totalmoney",e)},expression:"editForm.totalmoney"}})],1),e("el-form-item",{attrs:{label:"二维码","label-width":"100px"}},[e("el-image",{staticStyle:{height:"300px"},attrs:{src:a(38)}})],1)],1),e("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(e){return t.resetForm("editForm")}}},[t._v("取 消")]),e("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.back()}}},[t._v("归 还")])],1)],1),e("el-dialog",{attrs:{title:"报修",visible:t.repairsFlag,width:"600px","before-close":t.handleClose},on:{"update:visible":function(e){t.repairsFlag=e}}},[e("el-form",{ref:"repairsForm",attrs:{model:t.repairsForm}},[e("el-form-item",{attrs:{label:"报修原因","label-width":"100px"}},[e("el-input",{attrs:{type:"textarea",rows:5,placeholder:"请输入报修原因",autocomplete:"off"},model:{value:t.repairsForm.repairReason,callback:function(e){t.$set(t.repairsForm,"repairReason",e)},expression:"repairsForm.repairReason"}})],1)],1),e("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(e){return t.resetForm()}}},[t._v("取 消")]),e("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.goRepairs()}}},[t._v("报 修")])],1)],1)],1)},r=[],l={name:"order",data(){return{total:0,size:10,current:1,editForm:{},tableData:[],options:[{value:"1",label:"器材"},{value:"2",label:"赛事"},{value:"3",label:"场地"}],value:"1",backFlag:!1,repairsForm:{},repairsFlag:!1,userId:0,applyForm:{}}},created(){this.userId=window.sessionStorage.getItem("userId"),this.getOrderList()},methods:{cancel(t){this.$confirm("此操作将取消报名该比赛, 是否继续?","取消报名",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{this.$axios.post("/user/apply/cancel/"+t+"/"+this.userId).then((t=>{this.$message({type:"success",message:"取消报名成功!",onClose:()=>{this.value="2",this.getOrderList()}})}))}))},apply(t){this.applyForm.competitionid=t,this.applyForm.userid=this.userId,this.$confirm("此操作将报名该比赛, 是否继续?","报名",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{this.$axios.post("/user/apply/save",this.applyForm).then((t=>{this.$message({type:"success",message:"报名成功!",onClose:()=>{this.value="2",this.getOrderList()}})}))})).catch((()=>{this.$message({type:"info",message:"已取消报名"})}))},cancelAppointment(t){this.$confirm("此操作将取消预约该时间段的场地, 是否继续?","取消预约",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{this.$axios.post("/appointment/cancel/"+t).then((t=>{this.$message({type:"success",message:"取消预约成功!",onClose:()=>{this.value="3",this.getOrderList()}})}))}))},changeOtherList(t){this.value=t,this.getOrderList()},repairs(t,e){this.repairsFlag=!0,this.repairsForm.borrowid=t,this.repairsForm.userid=e},goRepairs(){this.$axios.post("/user/repairs/save",this.repairsForm).then((t=>{this.$message({showClose:!0,message:"恭喜你，报修成功",type:"success",onClose:()=>{this.value="1",this.getOrderList()}}),this.repairsFlag=!1}))},dateFormat(t){let e=new Date(t),a=e.getFullYear(),s=e.getMonth()+1<10?"0"+(e.getMonth()+1):e.getMonth()+1,r=e.getDate()<10?"0"+e.getDate():e.getDate();return a+"-"+s+"-"+r},handleSizeChange(t){console.log(`每页 ${t} 条`),this.size=t,this.getOrderList()},handleCurrentChange(t){console.log(`当前页: ${t}`),this.current=t,this.getOrderList()},resetForm(){this.backFlag=!1,this.repairsFlag=!1,this.editForm={}},handleClose(){this.resetForm()},getOrderList(){let t="";t="1"===this.value?"/borrow/getBorrowOrderByUser/"+this.userId:"2"===this.value?"/user/apply/getApplyOrderByUser/"+this.userId:"/appointment/getAppointmentOrderByUser/"+this.userId,this.$axios.get(t,{params:{current:this.current,size:this.size}}).then((t=>{this.tableData=t.data.data.pageData.records;for(let e=0;e<this.tableData.length;e++)this.tableData[e].starttime&&(this.tableData[e].starttime=this.dateFormat(this.tableData[e].starttime)),this.tableData[e].endtime&&(this.tableData[e].endtime=this.dateFormat(this.tableData[e].endtime)),this.tableData[e].created&&(this.tableData[e].created=this.dateFormat(this.tableData[e].created)),this.tableData[e].orderdate&&(this.tableData[e].orderdate=this.dateFormat(this.tableData[e].orderdate));this.size=t.data.data.pageData.size,this.current=t.data.data.pageData.current,this.total=t.data.data.pageData.total}))},back(){this.$axios.post("/borrow/back",this.editForm).then((t=>{this.$message({showClose:!0,message:"恭喜你，归还成功",type:"success",onClose:()=>{this.value="1",this.getOrderList()}}),this.backFlag=!1}))},getBackInfo(t){this.$axios.get("/borrow/getBackInfo/"+t).then((t=>{this.editForm=t.data.data.backInfo,this.editForm.starttime=this.dateFormat(this.editForm.starttime),this.editForm.endtime=this.dateFormat(this.editForm.endtime),this.backFlag=!0,(new Date).getTime()>new Date(this.editForm.endtime)&&(this.editForm.totalmoney=2*this.editForm.totalmoney)}))}}},i=l,o=a(1656),n=(0,o.A)(i,s,r,!1,null,"730caede",null),u=n.exports},38:function(t,e,a){t.exports=a.p+"img/erweima.c17e295e.jpg"}}]);
//# sourceMappingURL=276.01378303.js.map