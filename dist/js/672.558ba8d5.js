"use strict";(self["webpackChunkssm"]=self["webpackChunkssm"]||[]).push([[672],{9672:function(e,t,s){s.r(t),s.d(t,{default:function(){return M}});var n=function(){var e=this,t=e._self._c;return t("div",{staticClass:"layout"},[t("el-container",[t("el-aside",[t("Aside")],1),t("el-container",[t("el-header",[t("Header")],1),t("el-main",[t("Tabs"),t("router-view")],1)],1)],1)],1)},l=[],a=function(){var e=this,t=e._self._c;return t("el-row",{staticClass:"tac"},[t("el-col",{attrs:{span:12}},[t("el-menu",{staticClass:"el-menu-vertical-demo",attrs:{"default-active":this.$store.state.menus.editableTabsValue,"active-text-color":"#fff",collapse:e.isCollapse}},[t("div",{staticClass:"userInfo"},[t("div",{staticClass:"userHeader"},[t("div",{class:{userAvatar:!e.isCollapse}},[t("el-avatar",{staticStyle:{"margin-top":"10px"},attrs:{size:50,shape:"circle",src:e.userInfo.avatar}})],1),t("div",{staticClass:"username",class:{userName:e.isCollapse},staticStyle:{"white-space":"nowrap"}},[t("p",[e._v(e._s(e.userInfo.username))])])])]),t("router-link",{attrs:{to:"/index"}},[t("el-menu-item",{attrs:{index:"index"},on:{click:function(t){return e.selectMenu({name:"index",title:"首页"})}}},[t("i",{staticClass:"el-icon-s-home"}),t("template",{slot:"title"},[t("span",{attrs:{slot:"title"},slot:"title"},[e._v("首页")])])],2)],1),t("router-link",{attrs:{to:"/user/equipment"}},[t("el-menu-item",{attrs:{index:"equipment"},on:{click:function(t){return e.selectMenu({name:"equipment",title:"器材列表"})}}},[t("i",{staticClass:"el-icon-basketball"}),t("template",{slot:"title"},[t("span",{attrs:{slot:"title"},slot:"title"},[e._v("器材列表")])])],2)],1),t("router-link",{attrs:{to:"/user/competition"}},[t("el-menu-item",{attrs:{index:"competition"},on:{click:function(t){return e.selectMenu({name:"competition",title:"竞赛列表"})}}},[t("i",{staticClass:"el-icon-football"}),t("template",{slot:"title"},[t("span",{attrs:{slot:"title"},slot:"title"},[e._v("竞赛列表")])])],2)],1),t("router-link",{attrs:{to:"/notice/noticeList"}},[t("el-menu-item",{attrs:{index:"noticeList"},on:{click:function(t){return e.selectMenu({name:"noticeList",title:"公告列表"})}}},[t("i",{staticClass:"el-icon-message-solid"}),t("template",{slot:"title"},[t("span",{attrs:{slot:"title"},slot:"title"},[e._v("公告列表")])])],2)],1),e._l(e.menuList,(function(s,n){return t("el-submenu",{key:n,attrs:{index:s.name}},[t("template",{slot:"title"},[t("i",{class:s.icon}),t("span",{staticClass:"title"},[e._v(e._s(s.title))])]),e._l(s.children,(function(s,n){return t("router-link",{key:n,attrs:{to:s.path}},[t("el-menu-item",{attrs:{index:s.name},on:{click:function(t){return e.selectMenu(s)}}},[t("template",{slot:"title"},[t("i",{class:s.icon}),t("span",{attrs:{slot:"title"},slot:"title"},[e._v(e._s(s.title))])])],2)],1)}))],2)}))],2)],1)],1)},o=[],i={name:"Aside",data(){return{userInfo:{id:"",username:"",avatar:""}}},mounted(){this.getUserInfo()},computed:{isCollapse(){return this.$store.state.isCollapse},menuList:{get(){return this.$store.state.menus.menuList}}},methods:{selectMenu(e){this.$store.commit("addTab",e)},getUserInfo(){this.userInfo.username=window.sessionStorage.getItem("username"),this.userInfo.avatar=window.sessionStorage.getItem("avatar")}}},r=i,c=s(1656),u=(0,c.A)(r,a,o,!1,null,"2b946334",null),m=u.exports,d=function(){var e=this,t=e._self._c;return t("div",{staticClass:"Header"},[t("el-row",{attrs:{type:"flex",justify:"space-between",align:"middle"}},[t("el-col",{attrs:{span:6,type:"flex"}},[t("div",{staticClass:"toggle-button",on:{click:function(t){return e.changeCollapse()}}},[e.isCollapse?t("i",{staticClass:"el-icon-s-unfold"}):e._e(),e.isCollapse?e._e():t("i",{staticClass:"el-icon-s-fold"})])]),t("el-col",{staticStyle:{display:"flex","align-items":"center","justify-content":"center"},attrs:{span:8}},[t("el-avatar",{attrs:{shape:"circle",src:e.logo}}),t("p",{staticClass:"system-name"},[e._v("广东海洋大学体育管理系统")])],1),t("el-col",{staticStyle:{display:"flex","justify-content":"end","align-items":"center","margin-right":"20px"},attrs:{span:10}},[t("router-link",{attrs:{to:"/user/order"}},[t("span",{staticClass:"order"},[e._v("租用订单")])]),t("el-popover",{attrs:{placement:"left-end",width:300,trigger:"click"}},[e._l(this.borrowList.length>0?this.borrowList:this.compensateList,(function(s){return t("div",{key:s,staticClass:"notice_item"},[s.equipmentid?t("div",[t("span",{staticClass:"info"},[e._v(" "+e._s("一条来自 "+s.username+" 的器材申请，等待您的审批！！！ ")+" ")]),t("span",[e._v(e._s("申请时间： "+s.created))]),t("router-link",{attrs:{to:"/sys/Borrow"}},[t("span",{staticClass:"go-approve"},[e._v("去审批>>")])])],1):e._e(),s.borrowid?t("div",[t("span",{staticClass:"info"},[e._v(" "+e._s("您需要支付一笔器材赔偿，赔偿原因："+s.reason+",赔偿金额: "+s.price+"元，请尽快缴纳，否则无法租用器材")+" ")]),t("span",[e._v(e._s("时间： "+s.created))]),t("span",{staticClass:"go-approve",on:{click:function(t){return e.pay(s)}}},[e._v("去支付>>")])]):e._e()])})),t("el-button",{staticClass:"item",attrs:{slot:"reference"},slot:"reference"},[t("el-badge",{attrs:{value:this.num,max:99}},[t("i",{staticClass:"el-icon-message-solid",staticStyle:{width:"25px"}})])],1)],2),t("div",{staticClass:"fullScreen",on:{click:e.toggleFullscreen}},[t("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:e.isFull?"退出全屏":"全屏",placement:"bottom"}},[t("i",{class:e.isFull?"el-icon-aim":"el-icon-full-screen"})])],1),t("el-dropdown",[t("span",{staticClass:"el-dropdown-link",staticStyle:{color:"#fff",cursor:"pointer"}},[e._v(" "+e._s(e.userInfo.username)),t("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),t("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[t("el-dropdown-item",[t("router-link",{attrs:{to:"/userCenter"}},[e._v("个人中心")])],1),t("el-dropdown-item",{nativeOn:{click:function(t){return e.logout()}}},[e._v("退出系统")])],1)],1)],1)],1)],1)},h=[];s(4114);const p=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitCurrentFullScreenElement","webkitCancelFullScreen","webkitfullscreenchange","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError"]],f=(()=>{if("undefined"===typeof document)return!1;const e=p[0],t={};for(const s of p){const n=s?.[1];if(n in document){for(const[n,l]of s.entries())t[e[n]]=l;return t}}return!1})(),g={change:f.fullscreenchange,error:f.fullscreenerror};let b={request(e=document.documentElement,t){return new Promise(((s,n)=>{const l=()=>{b.off("change",l),s()};b.on("change",l);const a=e[f.requestFullscreen](t);a instanceof Promise&&a.then(l).catch(n)}))},exit(){return new Promise(((e,t)=>{if(!b.isFullscreen)return void e();const s=()=>{b.off("change",s),e()};b.on("change",s);const n=document[f.exitFullscreen]();n instanceof Promise&&n.then(s).catch(t)}))},toggle(e,t){return b.isFullscreen?b.exit():b.request(e,t)},onchange(e){b.on("change",e)},onerror(e){b.on("error",e)},on(e,t){const s=g[e];s&&document.addEventListener(s,t,!1)},off(e,t){const s=g[e];s&&document.removeEventListener(s,t,!1)},raw:f};Object.defineProperties(b,{isFullscreen:{get:()=>Boolean(document[f.fullscreenElement])},element:{enumerable:!0,get:()=>document[f.fullscreenElement]??void 0},isEnabled:{enumerable:!0,get:()=>Boolean(document[f.fullscreenEnabled])}}),f||(b={isEnabled:!1});var w=b,v={name:"Header",data(){return{logo:s(3153),borrowList:[],compensateList:[],num:0,userInfo:{id:"",username:""},isFull:!1}},created(){this.getUserInfo(),this.getBorrowNum()},mounted(){this.handleMsg()},computed:{isCollapse(){return this.$store.state.isCollapse}},methods:{getUserInfo(){this.userInfo.username=window.sessionStorage.getItem("username"),this.userInfo.id=window.sessionStorage.getItem("userId"),this.getCompensateNum()},handleMsg(){this.$globalWebSocket.ws.onmessage=this.getMessage},getMessage:function(e){this.$notify.info({title:"通知",message:e.data}),this.getBorrowNum(),this.getCompensateNum()},changeCollapse(){this.$store.commit("menuCollapse")},toggleFullscreen(){if(!w.isEnabled)return this.$notification.warning({message:"警告",description:"您的浏览器不支持全屏!"}),!1;w.toggle(),this.isFull=!this.isFull},pay(e){this.$confirm(`器材租用编号：${e.borrowid}，赔偿原因：${e.reason}，赔偿金额：${e.price}，是否继续支付`,"缴纳赔偿",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{this.$axios.post("/compensate/pay/"+e.id).then((e=>{this.$message({type:"success",message:"支付成功!",onClose:()=>{this.num--,this.getCompensateNum()}})}))}))},dateFormat(e){let t=new Date(e),s=t.getFullYear(),n=t.getMonth()+1<10?"0"+(t.getMonth()+1):t.getMonth()+1,l=t.getDate()<10?"0"+t.getDate():t.getDate();return s+"-"+n+"-"+l},getBorrowNum(){this.$axios.get("/sys/borrow/getBorrowNum").then((e=>{this.num=e.data.data.borrowNum,this.borrowList=e.data.data.borrowNoticeList;for(let t=0;t<this.borrowList.length;t++)this.borrowList[t].created=this.dateFormat(this.borrowList[t].created)}))},getCompensateNum(){console.log(this.userInfo.id),this.$axios.get("/compensate/getCompensateNum/"+this.userInfo.id).then((e=>{this.num+=e.data.data.compensateNum,this.compensateList=e.data.data.compensateList;for(let t=0;t<this.compensateList.length;t++)this.compensateList[t].created=this.dateFormat(this.compensateList[t].created)}))},logout(){this.$confirm("确定要退出系统吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{this.$axios.post("/logout").then((e=>{window.localStorage.clear(),window.sessionStorage.clear(),this.$store.commit("resetState"),this.$router.push("/login")}))})).catch((()=>!1))}}},k=v,C=(0,c.A)(k,d,h,!1,null,"21491cce",null),_=C.exports,x=function(){var e=this,t=e._self._c;return t("el-tabs",{attrs:{type:"card",closable:""},on:{"tab-remove":e.removeTab,"tab-click":e.clickTab},model:{value:e.editableTabsValue,callback:function(t){e.editableTabsValue=t},expression:"editableTabsValue"}},e._l(e.editableTabs,(function(e,s){return t("el-tab-pane",{key:e.name,attrs:{label:e.title,name:e.name}})})),1)},F=[],S={name:"Tabs",data(){return{}},computed:{editableTabs:{get(){return this.$store.state.menus.editableTabs},set(e){this.$store.state.menus.editableTabs=e}},editableTabsValue:{get(){return this.$store.state.menus.editableTabsValue},set(e){this.$store.state.menus.editableTabsValue=e}}},methods:{removeTab(e){let t=this.editableTabs,s=this.editableTabsValue;"index"!=e&&(s===e&&t.forEach(((n,l)=>{if(n.name===e){let e=t[l+1]||t[l-1];e&&(s=e.name)}})),this.editableTabsValue=s,this.editableTabs=t.filter((t=>t.name!==e)),this.$router.push({name:s}))},clickTab(e){this.$route.name!=e.name&&this.$router.push({name:e.name})}}},y=S,$=(0,c.A)(y,x,F,!1,null,"4b6bc3c4",null),T=$.exports,I={name:"layout",components:{Aside:m,Header:_,Tabs:T},created(){null!=this.userId&&this.initWebSocket()},methods:{initWebSocket(){let e=this;if("WebSocket"in window){console.log("您的浏览器支持 WebSocket!");let t="http://8.134.10.8:8081/websocket/"+this.userId;console.log(t),t=t.replace("https","ws").replace("http","ws"),e.ws=new WebSocket(t),e.$globalWebSocket.setWs(e.ws),e.ws.onopen=function(){console.log("webSocket connect successful")},e.ws.onclose=function(){console.log("webSocket connect closed"),setTimeout((()=>{e.initWebSocket()}),2e3)}}else console.log("您的浏览器不支持 WebSocket!")}},watch:{$route(e,t){if("/login"!=e.path){let t={name:e.name,title:e.meta.title};this.$store.commit("addTab",t)}}}},L=I,E=(0,c.A)(L,n,l,!1,null,"03717ccc",null),M=E.exports},3153:function(e,t,s){e.exports=s.p+"img/logo.05723836.png"}}]);
//# sourceMappingURL=672.558ba8d5.js.map